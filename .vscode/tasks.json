{
  "version": "2.0.0",
  "tasks": [
    {
      "command": "nix flake update",
      "group": {
        "isDefault": false,
        "kind": "build"
      },
      "label": "os-update",
      "type": "shell"
    },
    {
      "command": "nix run .#agenix -- --rekey -i ~/.ssh/age/primary.pub",
      "group": {
        "isDefault": false,
        "kind": "build"
      },
      "label": "os-rekey-age",
      "type": "shell"
    },
    {
      "command": "nix run .#git -- pull || exit 0",
      "group": {
        "isDefault": false,
        "kind": "build"
      },
      "label": "os-git-pull",
      "type": "shell"
    },
    {
      "command": "nix run .#git -- add . || exit 0",
      "group": {
        "isDefault": false,
        "kind": "build"
      },
      "label": "os-git-add",
      "type": "shell"
    },
    {
      "command": "nix fmt",
      "group": {
        "isDefault": false,
        "kind": "build"
      },
      "label": "format",
      "type": "shell"
    },
    {
      "command": "nix-env --delete-generations old",
      "group": {
        "isDefault": false,
        "kind": "build"
      },
      "label": "os-delete-generations",
      "type": "shell"
    },
    {
      "command": "nix run .#nh -- os switch .",
      "dependsOn": [
        "os-format",
        "os-git-pull",
        "os-git-add"
      ],
      "dependsOrder": "sequence",
      "group": {
        "isDefault": false,
        "kind": "build"
      },
      "label": "os-build",
      "type": "shell"
    },
    {
      "command": "nix-store --gc",
      "dependsOn": [
        "os-update",
        "os-delete-generations",
      ],
      "dependsOrder": "sequence",
      "group": {
        "isDefault": false,
        "kind": "build"
      },
      "label": "os-garbage",
      "type": "shell"
    }
  ]
}
